<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<h1 id="producto-nombre">Nombre del producto</h1>
<input type="hidden" id="producto-id" value="123566"/>

<a href="#" id="agregar-favoritos">Agregar a favoritos</a>

<script>

    function carga1(){
        //is_fovorite(document.getElementById("producto-id").value);

        var pokefav = document.querySelector("#producto-nombre")
        // cuando se pulsa en "agregar a favoritos"
        document.getElementById("agregar-favoritos").addEventListener("click", function(e) {

        // hacemos que no se ejecute el enlace
        e.preventDefault();

        // leemos los datos clave del producto y los guardamos en un objeto
        var datos = {
            id: document.getElementById("producto-id").value,
            nombre: document.getElementById("producto-nombre").textContent,
            url: document.location.href
        };

        // leemos los favoritos del localStorage
        var favoritos = localStorage.getItem("favoritos") || "[]";
        favoritos = JSON.parse(favoritos);
        console.log(favoritos)

        // buscamos el producto en la lista de favoritos
        var posLista = favoritos.findIndex(function(e) { return e.id == datos.id; });
        if (posLista > -1) {
            // si está, lo quitamos
            pokefav.style.color = "blue";
            favoritos.splice(posLista, 1);
        } else {
            // si no está, lo añadimos
            favoritos.push(datos);
            
            pokefav.style.color = "red";
        }

        // guardamos la lista de favoritos 
        localStorage.setItem("favoritos", JSON.stringify(favoritos));

        });
        
        
        ///https://es.stackoverflow.com/questions/108317/c%C3%B3mo-hacer-un-bot%C3%B3n-a%C3%B1adir-a-favoritos-con-javascript

    }
/*function is_fovorite(pokemon){
    console.log(pokemon)
}*/
carga1();

</script>
</body>
</html>

